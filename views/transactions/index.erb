<%require( 'pry-byebug' )%>

<h1>Transactions</h1>

<p><%=@now.strftime("%-B")%></p>

<%last_month = @now.prev_month%>
<p> <a href="transactions/<%=last_month.strftime("%-m")%>"> <%=last_month.strftime("%-B")%> </a> </p>
<%two_months_before = last_month.prev_month%>
<p> <a href="transactions/<%=two_months_before.strftime("%-m")%>"> <%=two_months_before.strftime("%-B")%> </a> </p>

<table>
  <tr>
    <th>Time</th>
    <th></th>
    <th>Date</th>
    <th></th>
    <th>Amount</th>
    <th></th>
    <th>Merchant</th>
    <th></th>
    <th>Tag</th>
  </tr>
  <% for transaction in @transactions %>

    <% if transaction.time_stamp.strftime("%-m") == @now.strftime("%-m") %>
      <tr>
        <td><%= transaction.time_stamp.strftime("%H:%M") %></td>
        <td>|</td>
        <td><%= transaction.time_stamp.strftime("%d.%m.%Y") %></td>
        <td>|</td>
        <td><%= transaction.amount %></td>
        <td>|</td>
        <td><a href="/merchants"> <%= transaction.find_merchant.merchant_name %></a></td>
        <td>|</td>
        <td><a href="/tags"><%= transaction.find_tag.tag_name.capitalize %></a></td>
      </tr>
    <%end%>
  <%end%>
</table>
